# 基于 DDH 的私有交集和协议

<img width="1281" height="1025" alt="image" src="https://github.com/user-attachments/assets/fc4cd5af-b43b-4acd-a154-cced621309c7" />

该协议按如下流程执行：首先是初始化，\(P_1\)和\(P_2\) 各自选群 \(\mathcal{G}\) 中随机私钥指数 \(k_1\)、\(k_2\) ，\(P_2\) 生成加法同态加密密钥对 \((pk, sk)\) 并把公钥 pk 发 \(P_1\) ；
接着第一轮，\(P_1\) 处理自身集合 V 里的元素 \(v_i\) ，
先哈希再用私钥指数 \(k_1\) 做指数运算，将结果打乱发给 \(P_2\) ；然后第二轮，\(P_2\) 先对收到的 \(P_1\) 结果用私钥指数 \(k_2\) 再次指数运算并打乱回发 \(P_1\) ，同时处理自身集合 W 里的 \((w_j, t_j)\) ，对 \(w_j\) 哈希后用 \(k_2\) 指数运算，对 \(t_j\) 用公钥 pk 加密，将这组结果打乱发给 \(P_1\) ；之后第三轮，\(P_1\) 对收到的 \(P_2\) 结果，用私钥指数 \(k_1\) 再次处理 \(w_j\) 相关运算结果，接着找交集集合 J ，
利用同态加密特性对交集对应的加密数值做加法，经刷新操作后发 \(P_2\) ；最后输出阶段，\(P_2\) 用私钥 sk 解密密文得到交集和，完成整个私有交集和计算流程 。



<img width="1132" height="276" alt="image" src="https://github.com/user-attachments/assets/c881d8af-1712-4b2b-8196-ec60d3291f98" />



